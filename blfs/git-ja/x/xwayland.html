<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      Xwayland-23.2.3
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL-NS Stylesheets Vsnapshot" />
    <style type="text/css">
    /*<![CDATA[*/
    body { background-image: url('images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }
    /*]]>*/
    </style>
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r12.0-1055+">
    <div class="navheader">
      <h4>
        Beyond Linux<sup>®</sup> From Scratch <span class="phrase">(System
        V</span> 版) - Version r12.0-1055+
      </h4>
      <h3>
        第24章 グラフィック環境
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="xkeyboard-config.html" title=
          "XKeyboardConfig-2.40">戻る</a>
          <p>
            XKeyboardConfig-2.40
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="xorg-server.html" title=
          "Xorg-Server-21.1.10">次へ</a>
          <p>
            Xorg-Server-21.1.10
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="installing.html" title=
          "第24章 グラフィック環境">上に戻る</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch    (System V 版) - Version r12.0-1055+">ホーム</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="ja" xml:lang="ja">
      <h1 class="sect1">
        <a id="xwayland" name="xwayland"></a>Xwayland-23.2.3
      </h1>
      <div class="package" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          Xwayland の概要
        </h2>
        <p>
          The <span class="application">Xwayland</span> package is an Xorg
          server running on top of the wayland server. It has been separated
          from the main Xorg server package. It allows running X clients
          inside a wayland session.
        </p>
        <div class="admon note">
          <img alt="[注記]" src="../images/note.png" />
          <h3>
            注記
          </h3>
          <p>
            LFS や依存パッケージが本ブックに示す最新安定バージョンでなかった場合には、BLFS
            開発版においては、パッケージのビルドや処理実行が適切に行われないことがあります。
          </p>
        </div>
        <h3>
          パッケージ情報
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                ダウンロード (HTTP): <a class="ulink" href=
                "https://www.x.org/pub/individual/xserver/xwayland-23.2.3.tar.xz">
                https://www.x.org/pub/individual/xserver/xwayland-23.2.3.tar.xz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                ダウンロード MD5 sum: 5f2effd2dd2433d8a7cdc05f8feadfb9
              </p>
            </li>
            <li class="listitem">
              <p>
                ダウンロードサイズ: 1.2 MB
              </p>
            </li>
            <li class="listitem">
              <p>
                必要ディスク容量: 27 MB (add 364 MB for tests)
              </p>
            </li>
            <li class="listitem">
              <p>
                概算ビルド時間: 0.2 SBU (with parallelism=4; add 1.7 SBU for tests,
                not including clone time)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Xwayland の依存パッケージ
        </h3>
        <h4>
          必須
        </h4>
        <p class="required">
          <a class="xref" href="libxcvt.html" title=
          "libxcvt-0.1.2">libxcvt-0.1.2</a>, <a class="xref" href=
          "../general/pixman.html" title="Pixman-0.42.2">Pixman-0.42.2</a>,
          <a class="xref" href="../general/wayland-protocols.html" title=
          "Wayland-Protocols-1.32">wayland-protocols-1.32</a>, <a class=
          "xref" href="x7app.html" title="Xorg アプリケーション">Xorg アプリケーション</a>
          (実行時), <a class="xref" href="x7font.html" title="Xorg フォント">Xorg
          フォント</a> (only font-util)
        </p>
        <h4>
          推奨
        </h4>
        <p class="recommended">
          <a class="xref" href="libepoxy.html" title=
          "libepoxy-1.5.10">libepoxy-1.5.10</a>, <a class="xref" href=
          "../basicnet/libtirpc.html" title=
          "libtirpc-1.3.4">libtirpc-1.3.4</a>, <a class="xref" href=
          "mesa.html" title="Mesa-23.3.1">Mesa-23.3.1</a>
        </p>
        <h4>
          任意
        </h4>
        <p class="optional">
          <a class="xref" href="../general/git.html" title=
          "Git-2.43.0">git-2.43.0</a> (to download packages needed for the
          tests), <a class="xref" href="../general/libgcrypt.html" title=
          "libgcrypt-1.10.3">libgcrypt-1.10.3</a>, <a class="xref" href=
          "../postlfs/nettle.html" title="Nettle-3.9.1">Nettle-3.9.1</a>,
          <a class="xref" href="../pst/xmlto.html" title=
          "xmlto-0.0.28">xmlto-0.0.28</a>, <a class="xref" href=
          "x7legacy.html" title="Xorg Legacy">Xorg Legacy Fonts</a> (only
          bdftopcf, for building fonts required for the tests), <a class=
          "ulink" href=
          "https://gitlab.freedesktop.org/xorg/test/rendercheck">rendercheck</a>
          (for tests), and <a class="ulink" href=
          "https://wayland.pages.freedesktop.org/weston/">weston</a> (for
          tests)
        </p>
      </div>
      <div class="installation" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          Xwayland のインストール
        </h2>
        <p>
          Install <span class="application">xwayland</span> by running the
          following commands:
        </p>
        <pre class="userinput"><kbd class=
        "command">sed -i '/install_man/,$d' meson.build &amp;&amp;

mkdir build &amp;&amp;
cd    build &amp;&amp;

meson setup --prefix=$XORG_PREFIX         \
            --buildtype=release           \
            -Dxkb_output_dir=/var/lib/xkb \
            ..                            &amp;&amp;
ninja</kbd></pre>
        <p>
          Building the test framework needs some work. First, <a class=
          "ulink" href=
          "https://wayland.pages.freedesktop.org/weston/">weston</a> brings
          in several dependencies, but the number can be reduced by disabling
          unneeded features. The <span class=
          "command"><strong>meson</strong></span> command for a stripped down
          build of <span class="application">weston</span> is shown in
          <a class="ulink" href=
          "https://gitlab.freedesktop.org/xorg/xserver/-/blob/xwayland-22.1/.gitlab-ci/debian-install.sh">
          Upstream continuous integration build</a>.
        </p>
        <p>
          Running the tests involves downloading two other frameworks, in
          addition to the mentioned optional dependencies:
        </p>
        <pre class="userinput"><kbd class="command">mkdir tools &amp;&amp;
pushd tools &amp;&amp;

git clone https://gitlab.freedesktop.org/mesa/piglit.git --depth 1 &amp;&amp;
cat &gt; piglit/piglit.conf &lt;&lt; EOF                                    &amp;&amp;
<code class="literal">[xts]
path=$(pwd)/xts
EOF</code>

git clone https://gitlab.freedesktop.org/xorg/test/xts --depth 1   &amp;&amp;

export DISPLAY=:22           &amp;&amp;
../hw/vfb/Xvfb $DISPLAY &amp;
VFB_PID=$!                   &amp;&amp;
cd xts                       &amp;&amp;
CFLAGS=-fcommon ./autogen.sh &amp;&amp;
make                         &amp;&amp;
kill $VFB_PID                &amp;&amp;
unset DISPLAY VFB_PID        &amp;&amp;
popd</kbd></pre>
        <p>
          Then the tests can be run with:
        </p>
        <pre class="userinput"><kbd class=
        "command">XTEST_DIR=$(pwd)/tools/xts PIGLIT_DIR=$(pwd)/tools/piglit ninja test</kbd></pre>
        <p>
          Now, as the <code class="systemitem">root</code> user:
        </p>
        <pre class="root"><kbd class="command">ninja install &amp;&amp;
cat &gt;&gt; /etc/sysconfig/createfiles &lt;&lt; "EOF"
<code class="literal">/tmp/.X11-unix dir 1777 root root</code>
EOF</kbd></pre>
        <p>
          If <a class="xref" href="xorg-server.html" title=
          "Xorg-Server-21.1.10">Xorg-Server-21.1.10</a> is not installed and
          you do not plan to install it later, you can install <span class=
          "command"><strong>Xvfb</strong></span> from this package. As the
          <code class="systemitem">root</code> user:
        </p>
        <pre class="userinput"><kbd class=
        "command">install -vm755 hw/vfb/Xvfb /usr/bin</kbd></pre>
      </div>
      <div class="commands" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          コマンド説明
        </h2>
        <p>
          <span class="command"><strong>sed -i '/install_man/,$d'
          meson.build</strong></span>: Prevents installing a manual page for
          <span class="command"><strong>Xserver</strong></span>, which is
          also provided by <a class="xref" href="xorg-server.html" title=
          "Xorg-Server-21.1.10">Xorg-Server-21.1.10</a>. Remove this command
          if <a class="xref" href="xorg-server.html" title=
          "Xorg-Server-21.1.10">Xorg-Server-21.1.10</a> is not installed and
          you don't plan to install it later.
        </p>
        <p>
          <em class="parameter"><code>--buildtype=release</code></em>:
          本パッケージの安定版リリース向けに適したビルドタイプを指定します。
          デフォルトにしていると、最適化されていないバイナリを生成する場合があるためです。
        </p>
        <p>
          <span class="command"><strong>cat &gt;&gt;
          /etc/sysconfig/createfiles...</strong></span>: This command creates
          the <code class="filename">/tmp/.X11-unix</code> directory at
          startup, and ensures that the permissions and ownership are correct
          as required by applications using Xwayland.
        </p>
      </div>
      <div class="content" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          パッケージ構成
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">インストールプログラム:</strong> <span class=
              "segbody">Xwayland</span>
            </div>
            <div class="seg">
              <strong class="segtitle">インストールライブラリ:</strong> <span class=
              "segbody">なし</span>
            </div>
            <div class="seg">
              <strong class="segtitle">インストールディレクトリ:</strong> <span class=
              "segbody">なし</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            概略説明
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="Xwayland" name="Xwayland"></a><span class=
                    "term"><span class=
                    "command"><strong>Xwayland</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Allows X clients to run under wayland
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="xkeyboard-config.html" title=
          "XKeyboardConfig-2.40">戻る</a>
          <p>
            XKeyboardConfig-2.40
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="xorg-server.html" title=
          "Xorg-Server-21.1.10">次へ</a>
          <p>
            Xorg-Server-21.1.10
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="installing.html" title=
          "第24章 グラフィック環境">上に戻る</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch    (System V 版) - Version r12.0-1055+">ホーム</a>
        </li>
      </ul>
    </div>
  </body>
</html>
