<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      Xorg-7 の概要
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL-NS Stylesheets Vsnapshot" />
    <style type="text/css">
    /*<![CDATA[*/
    body { background-image: url('images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }
    /*]]>*/
    </style>
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r12.0-1055+">
    <div class="navheader">
      <h4>
        Beyond Linux<sup>®</sup> From Scratch <span class=
        "phrase">(systemd</span> 版) - Version r12.0-1055+
      </h4>
      <h3>
        第24章 グラフィック環境
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="installing.html" title="グラフィック環境">戻る</a>
          <p>
            グラフィック環境
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="util-macros.html" title=
          "util-macros-1.20.0">次へ</a>
          <p>
            util-macros-1.20.0
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="installing.html" title=
          "第24章 グラフィック環境">上に戻る</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch  (systemd  版) - Version r12.0-1055+">ホーム</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="ja" xml:lang="ja">
      <h1 class="sect1">
        <a id="xorg7" name="xorg7"></a>Xorg-7 の概要
      </h1>
      <p>
        <span class="application">Xorg</span> は、再配布が可能な <span class=
        "application">X</span> ウィンドウシステムのオープンソース実装です。 このシステムは、ディスプレイハードウェア
        (マウス、キーボード、ビデオディスプレイ) とデスクトップ環境に対し、クライアント/サーバーのインターフェースを提供します。
        またウィンドウインフラストラクチャーと標準アプリケーションインターフェース (API; application interface)
        を提供します。
      </p>
      <h3>
        Xorg のダウンロードとインストール
      </h3>
      <p>
        Xorg-7.0
        では、完全に自動ツール化されたモジュールのビルドシステムが構築されていましたが、そのビルドシステムが新しいものとなったため、パッケージ全体を１つのファイルとしてダウンロードすることは出来なくなりました。
        実際にダウンロードサイトから入手すべきファイルは 100 個を超えます。
        必要となる大量のファイルのダウンロードを容易に行うために、<a class="xref" href=
        "../basicnet/wget.html" title="Wget-1.21.4">Wget-1.21.4</a>
        のインストールを是非行ってください。 <span class="application">wget</span>
        にて用いる正確なファイルリストについては、各節において明示します。 そのファイルリストには数多くのパッケージが含まれます。
      </p>
      <p>
        あまりに多くのパッケージが提供されているため、初めのうちは、自分がどのパッケージを入手してインストールすべきなのかを決めるのが大変かもしれません。
        そんな時は <a class="ulink" href=
        "https://wiki.x.org/wiki/ModuleDescriptions">このページ</a> や <a class=
        "ulink" href=
        "https://lists.x.org/archives/xorg-modular/2005-November/000801.html">
        このスレッド</a> を参考にしてください。
        どうにも分からない時は全パッケージをインストールすることになるかもしれませんが、その場合は余計なディスク容量を消費することになります。
      </p>
      <div class="admon note">
        <img alt="[注記]" src="../images/note.png" />
        <h3>
          注記
        </h3>
        <p>
          必要なパッケージのみをダウンロードしようとする場合であっても、wget ファイルはダウンロードしてください。
          このファイルではパッケージの依存関係を考慮してパッケージが並べられています。
          また互いにうまく動作するようなパッケージバージョンが列記されています。 さらに言うと wget
          ファイル内では、特定のパッケージが不適当であるとかインストールすべきではない、といったコメントも書かれています。
          より最新のパッケージバージョンは <span class="application">Xorg</span>
          の次期リリースバージョンにおいて用いるべきかもしれませんし、BLFS
          にてインストールする他のソフトウェアの現行バージョンでは動作しないことが明らかな場合もあります。 <span class=
          "application">Xorg</span>
          のインストールによって消費されるディスク容量は、本当に必要とするパッケージのみをインストールすることで、大幅に削減できるかもしれません。
          しかし BLFS ブックでは、個々の <span class="application">Xorg</span>
          パッケージにおける、すべての依存パッケージやビルドオプションについては、説明が網羅されていません。
          説明手順はあくまで、すべてのパッケージをビルドすることを前提としています。
        </p>
      </div>
      <p>
        Additionally, because of the large number of repetitive commands, you
        are encouraged to partially automate the build. Instructions have
        been given that utilize the <a class="xref" href=
        "../postlfs/sudo.html" title="Sudo-1.9.15p4">Sudo-1.9.15p4</a>
        package. It is recommended that you use the <em class=
        "parameter"><code>:NOPASSWD</code></em> configuration option for the
        user that will be building the xorg packages.
      </p>
      <div class="sect2" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          <a id="xorg-env" name="xorg-env"></a>Xorg ビルド環境の設定
        </h2>
        <div class="admon note">
          <img alt="[注記]" src="../images/note.png" />
          <h3>
            注記
          </h3>
          <p>
            The following instructions assume that the shell startup files
            have been set up as described in <a class="xref" href=
            "../postlfs/profile.html" title="Bash シェルの初期起動ファイル">Bash
            シェルの初期起動ファイル</a>.
          </p>
        </div>
        <p>
          As with previous releases of the X Window System, it may be
          desirable to install <span class="application">Xorg</span> into an
          alternate prefix. This is no longer common practice among Linux
          distributions. The common installation prefix for <span class=
          "application">Xorg</span> on Linux is <code class=
          "filename">/usr</code>. There is no standard alternate prefix, nor
          is there any exception in the current revision of the Filesystem
          Hierarchy Standard for Release 7 of the X Window System. Alan
          Coopersmith of Sun Microsystems, once stated "At Sun, we were using
          <code class="filename">/usr/X11</code> and plan to stick with it."
          Only the <code class="filename">/opt/*</code> prefix or the
          <code class="filename">/usr</code> prefix adhere to the current FHS
          guidelines.
        </p>
        <p>
          The BLFS editors recommend using the <code class=
          "filename">/usr</code> prefix.
        </p>
        <p>
          インストールプレフィックスを定めたら、以下のコマンドにより環境変数 <code class=
          "envar">XORG_PREFIX</code> にセットします。
        </p>
        <pre class="userinput"><kbd class=
        "command">export XORG_PREFIX="<em class=
        "replaceable"><code>&lt;PREFIX&gt;</code></em>"</kbd></pre>
        <p>
          インストール手順を通じては、すべてのパッケージに対して <span class=
          "command"><strong>configure</strong></span> へのパラメーター指定に以下を用います。
          環境変数 <code class="envar">XORG_CONFIG</code> にそのパラメーター指定を定義します。
        </p>
        <pre class="userinput"><kbd class=
        "command">export XORG_CONFIG="--prefix=$XORG_PREFIX --sysconfdir=/etc \
    --localstatedir=/var --disable-static"</kbd></pre>
        <p>
          <code class="systemitem">root</code> ユーザーになって、各種の変数設定を含めた
          <code class="filename">/etc/profile.d/xorg.sh</code> を生成します。
        </p>
        <pre class="root"><kbd class=
        "command">cat &gt; /etc/profile.d/xorg.sh &lt;&lt; EOF
<code class="literal">XORG_PREFIX="$XORG_PREFIX"
XORG_CONFIG="--prefix=\$XORG_PREFIX --sysconfdir=/etc --localstatedir=/var --disable-static"
export XORG_PREFIX XORG_CONFIG</code>
EOF
chmod 644 /etc/profile.d/xorg.sh</kbd></pre>
        <div class="admon note">
          <img alt="[注記]" src="../images/note.png" />
          <h3>
            注記
          </h3>
          <p>
            There is some confusion about the above 'here' document. The
            backslash in front of the dollar sign is correct. Bash will
            remove it when creating /etc/profile.d/xorg.sh. However, if you
            are creating the file with an editor, a copy and paste operation
            will not remove the backslash. It must then be removed manually.
          </p>
        </div>
        <p>
          If you've installed <a class="xref" href="../postlfs/sudo.html"
          title="Sudo-1.9.15p4">Sudo-1.9.15p4</a>, ensure that <code class=
          "envar">XORG_PREFIX</code> and <code class=
          "envar">XORG_CONFIG</code> are available in the <span class=
          "application">sudo</span> environment. As the <code class=
          "systemitem">root</code> user, run the following command:
        </p>
        <pre class="root"><kbd class=
        "command">cat &gt; /etc/sudoers.d/xorg &lt;&lt; EOF
<code class="literal">Defaults env_keep += XORG_PREFIX
Defaults env_keep += XORG_CONFIG</code>
EOF</kbd></pre>
        <h2>
          If you are not using the standard Xorg prefix...
        </h2>
        <div class="admon warning">
          <img alt="[警告]" src="../images/warning.png" />
          <h3>
            警告
          </h3>
          <p>
            If you've decided to use the standard <code class=
            "filename">/usr</code> prefix, you must omit the remainder of
            this page and continue at <a class="xref" href="util-macros.html"
            title="util-macros-1.20.0">util-macros-1.20.0</a>.
          </p>
        </div>
        <p>
          If you've decided to <span class="emphasis"><em>not</em></span> use
          the standard prefix, be sure to add <code class=
          "filename">$XORG_PREFIX/bin</code> to your <code class=
          "envar">PATH</code> environment variable, and <code class=
          "filename">$XORG_PREFIX/lib/pkgconfig</code> and <code class=
          "filename">$XORG_PREFIX/share/pkgconfig</code> to your <code class=
          "envar">PKG_CONFIG_PATH</code> variable. It is also helpful to
          specify additional search paths for <span class=
          "command"><strong>gcc</strong></span> and an include directory for
          the <span class="command"><strong>aclocal</strong></span> program.
          Issue the following commands as the <code class=
          "systemitem">root</code> user:
        </p>
        <pre class="userinput"><kbd class=
        "command">cat &gt;&gt; /etc/profile.d/xorg.sh &lt;&lt; "EOF"
<code class="literal">
pathappend $XORG_PREFIX/bin             PATH
pathappend $XORG_PREFIX/lib/pkgconfig   PKG_CONFIG_PATH
pathappend $XORG_PREFIX/share/pkgconfig PKG_CONFIG_PATH

pathappend $XORG_PREFIX/lib             LIBRARY_PATH
pathappend $XORG_PREFIX/include         C_INCLUDE_PATH
pathappend $XORG_PREFIX/include         CPLUS_INCLUDE_PATH

ACLOCAL="aclocal -I $XORG_PREFIX/share/aclocal"

export PATH PKG_CONFIG_PATH ACLOCAL LIBRARY_PATH C_INCLUDE_PATH CPLUS_INCLUDE_PATH</code>
EOF</kbd></pre>
        <p>
          The script above needs to be activated. Normally it will be
          automatic at login, but to activate it now, as a regular user, run:
        </p>
        <pre class="userinput"><kbd class=
        "command">source /etc/profile.d/xorg.sh</kbd></pre>
        <p>
          また <code class="filename">/etc/ld.so.conf</code> に対して <code class=
          "filename">$XORG_PREFIX/lib</code> を加える必要があります。 <code class=
          "systemitem">root</code> ユーザーになって以下を実行します。
        </p>
        <pre class="userinput"><kbd class=
        "command">echo "$XORG_PREFIX/lib" &gt;&gt; /etc/ld.so.conf</kbd></pre>
        <p>
          <code class="filename">/etc/man_db.conf</code> においては
          MANDATORY_MANPATH, MANPATH_MAP, MANDB_MAP の各エントリーを適切に設定することも必要です。
          以下は <code class="filename">/usr/X11R6</code> を書き換える例です。
          <code class="systemitem">root</code> ユーザーになって以下を実行します。
        </p>
        <pre class="userinput"><kbd class="command">sed -e "s@<em class=
        "replaceable"><code>X11R6/man</code></em>@X11R6/share/man@g" \
    -e "s@<em class=
"replaceable"><code>/usr/X11R6</code></em>@$XORG_PREFIX@g"   \
    -i /etc/man_db.conf</kbd></pre>
        <p>
          Some applications look for shared files in <code class=
          "filename">/usr/share/X11</code>. Create a symbolic link to the
          proper location as the <code class="systemitem">root</code> user:
        </p>
        <pre class="userinput"><kbd class=
        "command">ln -svf $XORG_PREFIX/share/X11 /usr/share/X11</kbd></pre>
        <p>
          If building KDE, some cmake files look for Xorg in places other
          than $XORG_PREFIX. Allow cmake to find Xorg with:
        </p>
        <pre class="userinput"><kbd class=
        "command">ln -svf $XORG_PREFIX /usr/X11R6</kbd></pre>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="installing.html" title="グラフィック環境">戻る</a>
          <p>
            グラフィック環境
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="util-macros.html" title=
          "util-macros-1.20.0">次へ</a>
          <p>
            util-macros-1.20.0
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="installing.html" title=
          "第24章 グラフィック環境">上に戻る</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch  (systemd  版) - Version r12.0-1055+">ホーム</a>
        </li>
      </ul>
    </div>
  </body>
</html>
