<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      Polkit-123
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL-NS Stylesheets Vsnapshot" />
    <style type="text/css">
    /*<![CDATA[*/
    body { background-image: url('images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }
    /*]]>*/
    </style>
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r12.0-1055+">
    <div class="navheader">
      <h4>
        Beyond Linux<sup>®</sup> From Scratch <span class=
        "phrase">(systemd</span> 版) - Version r12.0-1055+
      </h4>
      <h3>
        第4章 セキュリティ
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="p11-kit.html" title="p11-kit-0.25.3">戻る</a>
          <p>
            p11-kit-0.25.3
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="polkit-gnome.html" title=
          "polkit-gnome-0.105">次へ</a>
          <p>
            polkit-gnome-0.105
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="security.html" title="第4章 セキュリティ">上に戻る</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch  (systemd  版) - Version r12.0-1055+">ホーム</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="ja" xml:lang="ja">
      <h1 class="sect1">
        <a id="polkit" name="polkit"></a>Polkit-123
      </h1>
      <div class="package" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          Polkit の概要
        </h2>
        <p>
          <span class="application">Polkit</span>
          パッケージは、権限情報を定義し操作するためのツールキットです。 非特権 (unprivileged) プロセス から特権
          (privileged) プロセスへのアクセスを行う際に利用されます。
        </p>
        <div class="admon note">
          <img alt="[注記]" src="../images/note.png" />
          <h3>
            注記
          </h3>
          <p>
            LFS や依存パッケージが本ブックに示す最新安定バージョンでなかった場合には、BLFS
            開発版においては、パッケージのビルドや処理実行が適切に行われないことがあります。
          </p>
        </div>
        <h3>
          パッケージ情報
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                ダウンロード (HTTP): <a class="ulink" href=
                "https://gitlab.freedesktop.org/polkit/polkit/-/archive/123/polkit-123.tar.gz">
                https://gitlab.freedesktop.org/polkit/polkit/-/archive/123/polkit-123.tar.gz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                ダウンロード MD5 sum: 36540b837c588e1e77145523bb39f511
              </p>
            </li>
            <li class="listitem">
              <p>
                ダウンロードサイズ: 736 KB
              </p>
            </li>
            <li class="listitem">
              <p>
                必要ディスク容量: 6.8 MB (with tests)
              </p>
            </li>
            <li class="listitem">
              <p>
                概算ビルド時間: 0.3 SBU (with tests, using parallelism=4)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Polkit の依存パッケージ
        </h3>
        <h4>
          必須
        </h4>
        <p class="required">
          <a class="xref" href="../general/glib2.html" title=
          "GLib-2.78.3">GLib-2.78.3</a>
        </p>
        <h4>
          Recommended
        </h4>
        <p class="recommended">
          <a class="xref" href="../general/duktape.html" title=
          "duktape-2.7.0">duktape-2.7.0</a>, <a class="xref" href=
          "../general/gobject-introspection.html" title=
          "gobject-introspection-1.78.1">gobject-introspection-1.78.1</a>,
          <a class="xref" href="../general/libxslt.html" title=
          "libxslt-1.1.39">libxslt-1.1.39</a>, <span class=
          "phrase">and</span> <a class="xref" href="linux-pam.html" title=
          "Linux-PAM-1.5.3">Linux-PAM-1.5.3</a>
        </p>
        <div class="admon note">
          <img alt="[注記]" src="../images/note.png" />
          <h3>
            注記
          </h3>
          <p>
            Since <span class="phrase"><span class=
            "command"><strong>systemd-logind</strong></span></span> uses PAM
            to register user sessions, it is a good idea to build
            <span class="application">Polkit</span> with PAM support so
            <span class="phrase"><span class=
            "command"><strong>systemd-logind</strong></span></span> can track
            <span class="application">Polkit</span> sessions.
          </p>
        </div>
        <h4>
          任意
        </h4>
        <p class="optional">
          <a class="xref" href="../general/gtk-doc.html" title=
          "GTK-Doc-1.33.2">GTK-Doc-1.33.2</a>, <a class="xref" href=
          "../general/python-modules.html#python-dbusmock" title=
          "dbusmock-0.30.0">dbusmock-0.30.0</a>, and <a class="xref" href=
          "../general/spidermonkey.html" title=
          "SpiderMonkey from Firefox-115.5.0">SpiderMonkey from
          Firefox-115.5.0</a> (can be used in place of duktape)
        </p>
        <h4>
          Required Runtime Dependencies
        </h4>
        <p class="required">
          <a class="xref" href="../general/systemd.html" title=
          "Systemd-255">Systemd-255</a>
        </p>
        <h4>
          <a id="polkit-agent" name="polkit-agent"></a> Optional Runtime
          Dependencies
        </h4>
        <p class="optional">
          One polkit authentication agent for using polkit in the graphical
          environment: <span class="application">polkit-kde-agent</span> in
          <a class="xref" href="../kde/plasma-all.html" title=
          "Plasma 5 のビルド">Plasma-5.27.10</a> for KDE, the agent built in
          <a class="xref" href="../gnome/gnome-shell.html" title=
          "gnome-shell-45.2">gnome-shell-45.2</a> for GNOME3, <a class="xref"
          href="polkit-gnome.html" title=
          "polkit-gnome-0.105">polkit-gnome-0.105</a> for XFCE, and <a class=
          "xref" href="../lxqt/lxqt-policykit.html" title=
          "lxqt-policykit-1.4.0">lxqt-policykit-1.4.0</a> for LXQt
        </p>
        <div class="admon note">
          <img alt="[注記]" src="../images/note.png" />
          <h3>
            注記
          </h3>
          <p>
            <a class="xref" href="../general/libxslt.html" title=
            "libxslt-1.1.39">libxslt-1.1.39</a> をインストールしている場合は <a class=
            "xref" href="../pst/docbook.html" title=
            "docbook-xml-4.5">docbook-xml-4.5</a> と <a class="xref" href=
            "../pst/docbook-xsl.html" title=
            "docbook-xsl-nons-1.79.2">docbook-xsl-nons-1.79.2</a> が必要です。 また
            <a class="xref" href="../general/libxslt.html" title=
            "libxslt-1.1.39">libxslt-1.1.39</a> はインストールしていても、その DocBook
            パッケージ類をインストールしたくない場合は、後述する手順にて <code class=
            "option">-Dman=false</code> を指定することになります。
          </p>
        </div>
      </div>
      <div class="installation" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          Polkit のインストール
        </h2>
        <p>
          <span class="command"><strong>polkitd</strong></span>
          デーモンの起動には、これを制御するための専用のユーザーおよびグループが必要です。 そこで <code class=
          "systemitem">root</code> ユーザーになって以下を実行します。
        </p>
        <pre class="root"><kbd class=
        "command">groupadd -fg 27 polkitd &amp;&amp;
useradd -c "PolicyKit Daemon Owner" -d /etc/polkit-1 -u 27 \
        -g polkitd -s /bin/false polkitd</kbd></pre>
        <p>
          If using <a class="xref" href="../general/spidermonkey.html" title=
          "SpiderMonkey from Firefox-115.5.0">SpiderMonkey from
          Firefox-115.5.0</a>, make the following change (see Command
          Explanations below for more information):
        </p>
        <pre class="userinput"><kbd class=
        "command">sed -e '/mozjs/s/102/115/' -i meson.build      &amp;&amp;
sed -e 's/JS_Init/JS::DisableJitBackend(); &amp;/' \
    -i src/polkitbackend/polkitbackendjsauthority.cpp</kbd></pre>
        <p>
          一般ユーザーとして以下のコマンドを実行し <span class="application">Polkit</span>
          をビルドします。
        </p>
        <pre class="userinput"><kbd class="command">mkdir build &amp;&amp;
cd    build &amp;&amp;

meson setup ..                            \
      --prefix=/usr                       \
      --buildtype=release                 \
      -Dman=true                          \
      -Dsession_tracking=libsystemd-login \
      -Dtests=true                        &amp;&amp;
ninja</kbd></pre>
        <p>
          To test the results, first ensure that the system <span class=
          "application">D-Bus</span> daemon is running, and both <a class=
          "xref" href="../general/python-modules.html#dbus-python" title=
          "D-Bus Python-1.3.2">D-Bus Python-1.3.2</a> and <a class="xref"
          href="../general/python-modules.html#python-dbusmock" title=
          "dbusmock-0.30.0">dbusmock-0.30.0</a> are installed. Then run
          <span class="command"><strong>ninja test</strong></span>.
        </p>
        <p>
          <code class="systemitem">root</code> ユーザーになって以下を実行します。
        </p>
        <pre class="root"><kbd class="command">ninja install</kbd></pre>
      </div>
      <div class="commands" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          コマンド説明
        </h2>
        <p>
          <span class="command"><strong>sed -e '/mozjs/s/102/115/'
          meson.build</strong></span>: Allow building this package with
          SpiderMonkey from Firefox 115 ESR releases.
        </p>
        <p>
          <span class="command"><strong>sed -e
          's/JS_Init/JS::DisableJitBackend(); &amp;/' ...</strong></span> :
          The JIT compiling of <a class="xref" href=
          "../general/spidermonkey.html" title=
          "SpiderMonkey from Firefox-115.5.0">SpiderMonkey from
          Firefox-115.5.0</a> needs W+X mapping which is dangerous and is not
          permitted by the <span class="application">systemd</span> unit file
          shipped within the polkit package. This command is not strictly
          needed on systems based on sysvinit but it still improves security.
          It has no effect if building polkit with the recommended <a class=
          "xref" href="../general/duktape.html" title=
          "duktape-2.7.0">duktape-2.7.0</a> Javascript engine.
        </p>
        <p>
          <em class="parameter"><code>--buildtype=release</code></em>:
          本パッケージの安定版リリース向けに適したビルドタイプを指定します。
          デフォルトにしていると、最適化されていないバイナリを生成する場合があるためです。
        </p>
        <p>
          <em class="parameter"><code>-Dtests=true</code></em>: This switch
          allows to run the test suite of this package. As <span class=
          "application">Polkit</span> is used for authorizations, its
          integrity can affect system security. So it's recommended to run
          the test suite building this package.
        </p>
        <p>
          <code class="option">-Djs_engine=mozjs</code>: This switch allows
          using the <a class="xref" href="../general/spidermonkey.html"
          title="SpiderMonkey from Firefox-115.5.0">SpiderMonkey from
          Firefox-115.5.0</a> JavaScript engine instead of the <a class=
          "xref" href="../general/duktape.html" title=
          "duktape-2.7.0">duktape-2.7.0</a> JavaScript engine.
        </p>
        <p>
          <code class="option">-Dos_type=lfs</code>: Use this switch if you
          did not create the <code class="filename">/etc/lfs-release</code>
          file or distribution auto detection will fail and you will be
          unable to use <span class="application">Polkit</span>.
        </p>
        <p>
          <code class="option">-Dauthfw=shadow</code>: 本スイッチは認証フレームワークとして
          <span class="application">Linux-PAM</span> ではなく <span class=
          "application">Shadow</span> を使うことを指定します。 <span class=
          "application">Linux-PAM</span> をインストールしていない場合は、本スイッチを用いてください。
        </p>
        <p>
          <code class="option">-Dintrospection=false</code>: Use this option
          if you are certain that you do not need gobject-introspection files
          for polkit, or do not have gobject-introspection installed.
        </p>
        <p>
          <code class="option">-Dman=false</code>: Use this option to disable
          generating and installing manual pages. This is useful if libxslt
          is not installed.
        </p>
        <p>
          <code class="option">-Dexamples=true</code>: Use this option to
          build the example programs.
        </p>
        <p>
          <code class="option">-Dgtk_doc=true</code>: Use this option to
          enable building and installing the API documentation.
        </p>
      </div>
      <div class="content" lang="ja" xml:lang="ja">
        <h2 class="sect2">
          パッケージ構成
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">インストールプログラム:</strong> <span class=
              "segbody">pkaction, pkcheck, pkexec, pkttyagent, polkitd</span>
            </div>
            <div class="seg">
              <strong class="segtitle">インストールライブラリ:</strong> <span class=
              "segbody">libpolkit-agent-1.so, libpolkit-gobject-1.so</span>
            </div>
            <div class="seg">
              <strong class="segtitle">インストールディレクトリ:</strong> <span class=
              "segbody">/etc/polkit-1, /usr/include/polkit-1,
              /usr/lib/polkit-1, /usr/share/gtk-doc/html/polkit-1,
              /usr/share/polkit-1</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            概略説明
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="pkaction" name="pkaction"></a><span class=
                    "term"><span class=
                    "command"><strong>pkaction</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    登録されている PolicyKit アクションについての情報を取得するために用います。
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="pkcheck" name="pkcheck"></a><span class=
                    "term"><span class=
                    "command"><strong>pkcheck</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    プロセスがアクションを行う権限を有するかどうかをチェックするために用います。
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="pkexec" name="pkexec"></a><span class=
                    "term"><span class=
                    "command"><strong>pkexec</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    認証されたユーザーが、他ユーザーとなってコマンド実行することを許可します。
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="pkttyagent" name="pkttyagent"></a><span class=
                    "term"><span class=
                    "command"><strong>pkttyagent</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    プロセスなどに対して、テキスト情報による権限エージェントを開始します。
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="polkitd" name="polkitd"></a><span class=
                    "term"><span class=
                    "command"><strong>polkitd</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    システムメッセージバス上にて、org.freedesktop.PolicyKit1 なる <span class=
                    "application">D-Bus</span> サービスを提供します。
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libpolkit-agent-1" name=
                    "libpolkit-agent-1"></a><span class="term"><code class=
                    "filename">libpolkit-agent-1.so</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    <span class="application">Polkit</span> の認証エージェント API
                    関数を提供します。
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libpolkit-gobject-1" name=
                    "libpolkit-gobject-1"></a><span class="term"><code class=
                    "filename">libpolkit-gobject-1.so</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    <span class="application">Polkit</span> 認証 API 関数を提供します。
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="p11-kit.html" title="p11-kit-0.25.3">戻る</a>
          <p>
            p11-kit-0.25.3
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="polkit-gnome.html" title=
          "polkit-gnome-0.105">次へ</a>
          <p>
            polkit-gnome-0.105
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="security.html" title="第4章 セキュリティ">上に戻る</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch  (systemd  版) - Version r12.0-1055+">ホーム</a>
        </li>
      </ul>
    </div>
  </body>
</html>
